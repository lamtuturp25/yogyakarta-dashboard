<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="./resources/ol.css">
    <link rel="stylesheet" href="resources/fontawesome-all.min.css">
    <link rel="stylesheet" href="./resources/ol-layerswitcher.css">
    <link rel="stylesheet" href="./resources/qgis2web.css">

    <style>
      html, body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        background-color: #ffffff;
      }

      #map {
        width: 100vw;
        height: 100vh;
      }

      #bulanNDVI {
        position: absolute;
        top: 10px;
        left: 10px;
        z-index: 1000;
        background: white;
        padding: 5px 10px;
        font-size: 14px;
        border-radius: 4px;
        border: 1px solid #ccc;
      }

      .ol-control > * {
        background-color: #f8f8f8!important;
        color: #444444!important;
      }

      .ol-control {
        background-color: rgba(255,255,255,.4) !important;
        padding: 2px !important;
      }
    </style>

    <title>Peta NDVI Dinamis</title>
  </head>

  <body>
    <!-- Dropdown Bulan -->
    <select id="bulanNDVI">
      <option value="NDVI_01_2024_2">Januari 2024</option>
      <option value="NDVI_02_2024_3">Februari 2024</option>
      <option value="NDVI_03_2024_4">Maret 2024</option>
    </select>

    <!-- Map -->
    <div id="map">
      <div id="popup" class="ol-popup">
        <a href="#" id="popup-closer" class="ol-popup-closer"></a>
        <div id="popup-content"></div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="resources/qgis2web_expressions.js"></script>
    <script src="./resources/functions.js"></script>
    <script src="./resources/ol.js"></script>
    <script src="./resources/ol-layerswitcher.js"></script>

    <!-- Layers dan Styles -->
    <script src="layers/Administrasi_Kecamatan_1.js"></script>
    <script src="layers/NDVI_01_2024_2.js"></script>
    <script src="layers/NDVI_02_2024_3.js"></script>
    <script src="layers/NDVI_03_2024_4.js"></script>
    <script src="styles/Administrasi_Kecamatan_1_style.js"></script>
    <script src="styles/NDVI_01_2024_2_style.js"></script>
    <script src="styles/NDVI_02_2024_3_style.js"></script>
    <script src="styles/NDVI_03_2024_4_style.js"></script>
    <script src="./layers/layers.js" type="text/javascript"></script> 
    <script src="./resources/Autolinker.min.js"></script>
    <script src="./resources/qgis2web.js"></script>

    <!-- Script Interaktif: NDVI Bulanan -->
    <script>
      window.onload = function () {
        // Ambil semua layer NDVI
        const ndviLayers = {
          'NDVI_01_2024_2': layersList.find(l => l.get('title') === 'NDVI_01_2024_2'),
          'NDVI_02_2024_3': layersList.find(l => l.get('title') === 'NDVI_02_2024_3'),
          'NDVI_03_2024_4': layersList.find(l => l.get('title') === 'NDVI_03_2024_4')
        };

        // Atur hanya layer pertama yang aktif
        for (const key in ndviLayers) {
          ndviLayers[key].setVisible(key === 'NDVI_01_2024_2');
        }

        // Saat bulan dipilih, ganti layer yang aktif
        document.getElementById('bulanNDVI').addEventListener('change', function () {
          const selected = this.value;
          for (const key in ndviLayers) {
            ndviLayers[key].setVisible(key === selected);
          }
        });
      };
    </script>
  </body>
</html>
